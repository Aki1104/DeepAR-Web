<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AR Canvas</title>
    <link href="https://fonts.googleapis.com/css2?family=Caveat&display=swap" rel="stylesheet" />
    <!-- DeepAR browser SDK v5.6.3 (pre-deprecation for foot tracking) -->
    <script src="https://cdn.jsdelivr.net/npm/deepar@5.6.3/js/deepar.js"></script>
</head>
<body>
    <!-- AR preview container -->
    <div style="width: 480px; height: 270px" id="deepar-div"></div>
    <!-- Camera switch button -->
    <button onclick="switchCamera()">Switch Camera</button>

    <!-- DeepAR initialization and effect switch -->
    <script>
        let deepAR;

        (async function () {
            try {
                deepAR = await deepar.initialize({
                    licenseKey: '247704b47c32f030b2b526dde74bc7220426d3f3f390f51ed573bf0da398e590bc8f12a8923a7da4',
                    previewElement: document.querySelector('#deepar-div'),
                }, {
                    additionalOptions: {
                        cameraConfig: {
                            facingMode: 'environment' // Back camera for feet
                        }
                    }
                });
                console.log("‚úÖ DeepAR initialized with back camera.");

                // Explicitly initialize foot tracking (v5.6.3 supports this)
                await deepAR.initFootTracking();
                console.log("‚úÖ Foot tracking initialized.");

                await deepAR.switchEffect('./effects/filters/basketball_black.deepar');
                console.log('‚úÖ Custom shoe effect loaded successfully!');

                deepAR.callbacks.onFeetVisibilityChanged = (visible) => {
                    console.log(visible ? 'üëü Feet detected!' : 'No feet visible.');
                };
            } catch (err) {
                console.error("‚ùå Error:", err);
            }
        })();

        function switchCamera() {
            alert('Dynamic switching not supported in v5.6.3.\nTo switch:\n1. Edit facingMode to "user" (front).\n2. Reload page.');
        }
    </script>
</body>
</html>